# 애플리케이션 설계

## (Controller / Service / Repository 역할 분리)

이 문서는
앞 단계에서 정리한 **요구사항과 분석 모델**을 바탕으로,
실제 애플리케이션을 구성할 때 필요한 **역할 분리 기준**을 정의한다.

아직 구체적인 코드나 구현 방법을 다루지 않으며,
"어떤 책임을 어떤 위치에 둘 것인가"에 집중한다.

---

## 강의 목표

이 단계에서는 **분석 모델에서 정리한 흐름과 책임을
실제 애플리케이션 코드 구조로 옮기기 위한 기준**을 세운다.

학생이 다음을 명확히 이해하는 것이 목표이다.

* Controller / Service / Repository는 왜 나뉘는가
* 각 계층이 책임져야 할 일과 하면 안 되는 일
* 이 분리가 이후 유지보수와 확장에 어떤 영향을 주는가

---

## 강의 목표

이 단계에서는 **분석 모델에서 정리한 흐름과 책임을
실제 애플리케이션 코드 구조로 옮기기 위한 기준**을 세운다.

학생이 다음을 명확히 이해하는 것이 목표이다.

* Controller / Service / Repository는 왜 나뉘는가
* 각 계층이 책임져야 할 일과 하면 안 되는 일
* 이 분리가 이후 유지보수와 확장에 어떤 영향을 주는가

---

## 1. 이 단계의 위치

지금까지의 흐름을 정리하면 다음과 같다.

1. 현행 시스템 분석 → 왜 기존 방식이 한계에 도달했는가
2. 요구사항 정의 → 시스템이 무엇을 해야 하는가
3. 분석 모델 정의 → 시스템이 어떻게 동작해야 하는가

이제 남은 질문은 하나다.

> **"이 흐름과 책임을
> 실제 코드 구조로는 어떻게 나눌 것인가?"**

이 질문에 답하는 단계가 바로
애플리케이션 설계다.

---

## 2. 애플리케이션 설계란 무엇인가

애플리케이션 설계는
곧바로 코드를 작성하는 단계가 아니다.

이 단계의 목적은 다음과 같다.

* 코드 작성 전에 **역할의 경계**를 먼저 고정한다
* 한 책임이 여러 계층에 흩어지지 않도록 막는다
* 나중에 코드를 수정할 때 영향을 최소화한다

> 즉,
> 애플리케이션 설계는
> **코드를 지키기 위한 약속을 만드는 단계**다.

---

## 3. 왜 역할 분리가 필요한가

역할 분리가 없는 코드는
다시 01단계의 문제로 되돌아간다.

* 요청 처리와 로직이 섞인다
* 로직과 DB 접근이 뒤엉킨다
* 수정 범위를 예측할 수 없어진다

역할 분리는
이 문제를 **구조적으로 차단**하기 위한 장치다.

---

## 4. Controller의 책임

Controller는
**외부 세계와 내부 시스템을 연결하는 입구**다.

### Controller가 해야 할 일

* HTTP 요청을 받는다
* 요청 데이터를 읽고 검증한다
* 로그인/권한 여부를 확인한다
* Service에 처리를 위임한다
* Service 결과를 HTTP 응답으로 변환한다

### Controller가 해서는 안 되는 일

* 비즈니스 로직 처리 ❌
* SQL 작성 및 실행 ❌
* 트랜잭션 제어 ❌

> Controller는
> "결정하지 않고 전달만 한다"는 원칙을 가진다.

---

## 5. Service의 책임

Service는
**시스템의 핵심 로직과 흐름을 책임지는 계층**이다.

### Service가 해야 할 일

* 비즈니스 규칙을 적용한다
* 여러 작업을 하나의 흐름으로 묶는다
* 트랜잭션 범위를 결정한다
* 권한 검사의 핵심 판단을 수행한다

### Service가 해서는 안 되는 일

* HTTP 요청/응답 처리 ❌
* SQL 직접 작성 ❌

> Service는
> "이 기능이 어떻게 동작해야 하는지"를 알고 있다.

---

## 6. Repository의 책임

Repository는
**데이터 접근만을 전담하는 계층**이다.

### Repository가 해야 할 일

* 데이터 조회
* 데이터 저장
* 데이터 수정 및 삭제

### Repository가 해서는 안 되는 일

* 비즈니스 규칙 판단 ❌
* 요청/응답 처리 ❌

> Repository는
> "어떤 SQL을 실행할지"만 책임진다.

---

## 7. 역할 분리가 주는 효과

이 구조를 따르면 다음과 같은 효과가 있다.

* 한 계층의 변경이 다른 계층에 미치는 영향 최소화
* 테스트 단위 명확화
* 코드 가독성과 유지보수성 향상

---

## 8. 이 단계의 핵심 정리

애플리케이션 설계 단계의 핵심은 다음 한 문장이다.

> **"코드를 나누는 것이 아니라,
> 책임을 나눈다"**

이 기준이 명확하면
코드는 자연스럽게 정리된다.

---

## 다음 단계

이제 각 역할이 정해졌으므로,
다음 단계에서는 실제 코드 구조와
공통으로 재사용할 모듈을 정의한다.

→ [**공통 모듈 및 역할 설계**](./02-common-module-design.md)
