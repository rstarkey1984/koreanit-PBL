# 공통 모듈 및 역할 설계

이 문서는 프로젝트 전반에서 반복되는 요소를 **공통 모듈로 정의**하고
각 역할의 책임 범위를 **최소 규칙으로 고정**한다.

구현 코드는 포함하지 않는다.

---

## 1. 공통 규칙의 필요

현행 시스템(단일 컨트롤러 중심 구조)에서는
인증, 예외 처리, 응답 포맷 같은 요소가 API마다 반복되면서

* 중복 코드 증가
* 수정 영향 범위 확대
* 일관성 붕괴

문제가 발생했다.

본 단계에서는 이를 방지하기 위해
"반드시 공통으로 처리해야 하는 것"을 먼저 확정한다.

---

## 2. 공통 응답 포맷

모든 API는 동일한 형태의 응답 포맷을 사용한다.

* 성공 응답

  * success: true
  * data: 결과 데이터
  * message: 안내 메시지(선택)

* 실패 응답

  * success: false
  * error: 에러 코드/이름
  * message: 사용자 메시지

응답 포맷은 controller에서 직접 구성하지 않고
공통 응답 객체/헬퍼를 통해 생성한다.

---

## 3. 공통 예외 처리

예외 처리는 각 controller에서 개별 처리하지 않고
전역 처리(공통 핸들러)로 일원화한다.

* 입력값 오류(Validation)
* 인증/권한 오류
* 리소스 없음(404)
* 서버 내부 오류(500)

공통 예외 처리는
"어떤 상황에서 어떤 HTTP 상태코드로 응답할지"를 기준으로 정의한다.

---

## 4. 인증/세션 공통 처리

본 프로젝트의 인증은 세션 기반을 기본으로 한다.

* 로그인 성공 시 서버는 로그인 상태를 유지한다
* 보호된 API는 로그인 여부를 사전에 확인한다
* 권한이 필요한 작업(삭제 등)은 작성자 확인을 수행한다

인증/권한 체크는
각 controller의 비즈니스 로직과 분리하여
공통 처리(예: 인터셉터/필터/어노테이션 정책)로 운영한다.

---

## 5. 입력 검증(Validation) 공통 기준

입력값 검증은 다음 원칙을 따른다.

* controller 진입 단계에서 검증한다
* 검증 실패는 공통 예외 처리 규칙에 따라 응답한다
* 비즈니스 규칙 검증은 service 영역에서 수행한다

---

## 6. 역할별 책임 범위(최소 규칙)

### 6-1. Controller

* HTTP 요청 수신 및 응답 변환
* 입력 검증 트리거(요청 DTO 검증)
* service 호출
* 공통 응답 포맷으로 반환

Controller는 SQL을 직접 실행하지 않는다.

---

### 6-2. Service

* 업무 흐름(Use Case) 조합
* 권한/작성자 검증(비즈니스 규칙)
* 트랜잭션 경계 설정

Service는 HTTP 객체(Request/Response)를 다루지 않는다.

---

### 6-3. Repository

* 데이터 접근(SQL 실행)
* 조회/저장/수정/삭제의 책임

Repository는 비즈니스 규칙 판단을 하지 않는다.

---

## 7. 외부 데이터 연동은 어디에서 다루는가

* 외부 연동 대상: Google News RSS(IT 뉴스) 기반 수집
* 연동 결과: 서버가 뉴스 목록을 API 응답 형태로 제공

연동 방식/데이터 흐름/오류 처리 정책은
다음 문서(연동 설계)에서 확정한다.

---

## 8. 이 단계의 정리

공통 모듈 설계 단계에서는

* 응답 포맷
* 예외 처리
* 인증/권한
* 입력 검증
* 역할별 책임 규칙

을 최소 규칙으로 고정한다.

다음 단계에서는
타 시스템 연동(뉴스 RSS 수집) 관점에서
**연동 흐름과 데이터 구성**을 설계한다.

---

## 다음 단계

→ [**타 시스템 연동 설계**](02-integration-design.md)
