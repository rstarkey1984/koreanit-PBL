# 공통 모듈 및 역할 설계

## 강의 목표

이 단계에서는 애플리케이션 전반에서 **반복적으로 사용되는 책임을 공통 모듈로 분리**하는 기준을 정한다.

학생이 다음을 이해하는 것이 목표이다.

* 왜 공통 모듈이 필요한지
* 어떤 책임이 공통 모듈로 분리되어야 하는지
* 공통 모듈이 애플리케이션 구조를 어떻게 안정시키는지

---

## 1. 왜 공통 모듈이 필요한가

애플리케이션을 구현하다 보면
다음과 같은 코드가 여러 곳에서 반복된다.

* 응답 포맷 구성
* 예외 처리
* 로그인/권한 검사
* 요청 로그 기록

이 코드들을 각 Controller나 Service에 흩어 놓으면,
수정이 필요할 때 **모든 위치를 함께 수정해야 하는 문제**가 발생한다.

> 공통 모듈은
> "여러 곳에서 반복되는 책임을
> 한 곳에 모아 관리하기 위한 장치"다.

---

## 2. 공통 모듈의 기본 원칙

공통 모듈을 설계할 때는 다음 원칙을 따른다.

* 특정 기능에 종속되지 않는다
* 비즈니스 로직을 포함하지 않는다
* 여러 Controller/Service에서 재사용 가능해야 한다

> 공통 모듈은
> "업무를 처리하는 곳"이 아니라
> "업무를 돕는 기반"이다.

---

## 3. 공통 응답 포맷

### 3-1. 왜 응답 포맷을 통일해야 하는가

API마다 응답 형식이 다르면
클라이언트는 매번 다른 방식으로 응답을 해석해야 한다.

이를 방지하기 위해
응답 형식을 하나로 통일한다.

### 3-2. 공통 응답의 역할

* 성공/실패 여부 표현
* 메시지 전달
* 실제 데이터 포함

> 응답 포맷 통일은
> 클라이언트와의 **약속**이다.

---

## 4. 공통 예외 처리

### 4-1. 예외를 공통으로 처리하는 이유

각 Controller마다 try-catch를 두면
코드가 복잡해지고 일관성이 깨진다.

공통 예외 처리는
시스템 전반의 오류 대응 방식을 하나로 묶는다.

### 4-2. 공통 예외 처리의 책임

* 예외를 사용자에게 전달 가능한 형태로 변환
* 로그 기록
* 일관된 오류 응답 생성

---

## 5. 인증 및 권한 공통 처리

로그인 여부 확인과 권한 검사는
여러 기능에서 반복적으로 필요하다.

이를 각 Controller에서 처리하지 않고,
공통 모듈로 분리함으로써 다음을 얻는다.

* 인증 규칙 변경 시 수정 범위 최소화
* 권한 검사 로직의 일관성 유지

> 인증은 기능이 아니라
> **시스템 규칙**이다.

---

## 6. 요청 로깅

### 6-1. 로깅이 필요한 이유

* 장애 원인 추적
* 사용자 행동 분석
* 시스템 상태 파악

### 6-2. 공통 로깅의 장점

* 모든 요청을 동일한 기준으로 기록
* 로그 형식 통일

---

## 이 단계의 핵심 정리

공통 모듈 설계의 핵심은 다음 한 문장이다.

> **"반복되는 책임은
> 반드시 구조로 분리한다"**

이 기준이 지켜지면
애플리케이션 구조는 쉽게 무너지지 않는다.

---

## 다음 단계

이제 애플리케이션의 구조와 기반이 마련되었다.

→ [**타 시스템 연동 설계**](./03-integration-design.md)
